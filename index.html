<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Аватария - скрытые фишки и малоочевидные факты</title>
  <style>
    :root{
      --bg:#0b0c10;
      --glass:rgba(255,255,255,.06);
      --glass2:rgba(255,255,255,.10);
      --stroke:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.62);
      --shadow:0 24px 80px rgba(0,0,0,.45);
      --r:22px;
      --a:#8ab4ff;
      --g:#6ee7b7;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, -apple-system, BlinkMacSystemFont, "SF Pro Display","SF Pro Text",
              "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f7fb;
        --glass:rgba(0,0,0,.04);
        --glass2:rgba(0,0,0,.06);
        --stroke:rgba(0,0,0,.10);
        --text:rgba(0,0,0,.88);
        --muted:rgba(0,0,0,.60);
        --shadow:0 24px 80px rgba(0,0,0,.12);
        --a:#1d4ed8;
        --g:#047857;
      }
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 900px at 18% 10%, rgba(138,180,255,.18), transparent 60%),
        radial-gradient(1000px 900px at 50% 110%, rgba(110,231,183,.12), transparent 60%),
        var(--bg);
      letter-spacing:-0.01em;
      line-height:1.55;
    }
    .wrap{ max-width:980px; margin:0 auto; padding:26px 16px 52px; }

    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:8px 2px 18px;
    }
    .brand{ display:flex; align-items:center; gap:12px; user-select:none; }
    .logo{
      width:34px; height:34px; border-radius:12px;
      background:linear-gradient(135deg, rgba(138,180,255,.92), rgba(110,231,183,.86));
      box-shadow:0 14px 40px rgba(0,0,0,.22);
      position:relative; overflow:hidden;
    }
    .logo::after{
      content:""; position:absolute; inset:-40%;
      background:radial-gradient(circle at 30% 30%, rgba(255,255,255,.70), transparent 45%);
      transform:rotate(20deg); opacity:.55;
    }
    .brand small{
      display:block; color:var(--muted);
      font-weight:700; letter-spacing:.04em; text-transform:uppercase; font-size:12px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px; border-radius:999px;
      background:var(--glass); border:1px solid var(--stroke);
      backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
      box-shadow:var(--shadow);
      color:var(--muted); font-size:13px; white-space:nowrap;
    }
    .dot{ width:8px; height:8px; border-radius:50%; background:var(--a); box-shadow:0 0 0 4px rgba(138,180,255,.14); }

    .hero{
      border-radius:var(--r);
      background:linear-gradient(180deg, var(--glass2), var(--glass));
      border:1px solid var(--stroke);
      backdrop-filter: blur(18px); -webkit-backdrop-filter: blur(18px);
      box-shadow:var(--shadow);
      padding:22px 18px;
    }
    h1{
      margin:0 0 10px;
      font-size:clamp(26px, 4vw, 38px);
      line-height:1.12;
      letter-spacing:-0.04em;
    }
    .lead{ margin:0; color:var(--muted); font-size:15px; max-width:72ch; }

    main{
      margin-top:14px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media (max-width: 860px){ main{ grid-template-columns:1fr; } }

    .card{
      border-radius:var(--r);
      background:linear-gradient(180deg, var(--glass2), var(--glass));
      border:1px solid var(--stroke);
      backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
      box-shadow:var(--shadow);
      padding:16px;
    }
    .card h2{
      margin:0 0 10px;
      font-size:16px;
      letter-spacing:-0.02em;
    }

    .item{
      border-radius:16px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.05);
      padding:12px;
      margin:10px 0 0;
    }
    .row{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .tag{
      font-family:var(--mono);
      font-size:12px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(0,0,0,.12);
      color:var(--muted);
      white-space:nowrap;
    }
    @media (prefers-color-scheme: light){ .tag{ background:rgba(255,255,255,.55); } }
    .item h3{ margin:0; font-size:14px; }
    .item p{ margin:6px 0 0; color:var(--muted); font-size:13px; }
    .item ul{ margin:8px 0 0 18px; color:var(--muted); font-size:13px; }
    .item li{ margin:6px 0; }

    .hint{
      margin-top:12px;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background:rgba(138,180,255,.10);
      color:var(--muted);
      font-size:13px;
    }
    .hint b{ color:var(--text); }
    a{ color:inherit; }
    .links a{ color:var(--a); text-decoration:none; border-bottom:1px solid rgba(138,180,255,.35); }
    .links a:hover{ border-bottom-color: rgba(138,180,255,.7); }

    footer{
      margin-top:14px;
      color:var(--muted);
      font-size:12px;
      display:flex; justify-content:space-between; gap:12px; flex-wrap:wrap;
      padding:10px 4px 0;
    }
    .k{ color:var(--text); font-weight:700; }
    .ok{ color:var(--g); font-weight:700; }

    .mini{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;
    }
    .mini .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      color:var(--muted); font-size:12px;
    }
    .chip i{ width:8px; height:8px; border-radius:50%; background:var(--g); display:inline-block; box-shadow:0 0 0 4px rgba(110,231,183,.12); }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div><small>Avataria</small></div>
      </div>
      <div class="pill"><span class="dot" aria-hidden="true"></span>коротко и по делу</div>
    </header>

    <section class="hero">
      <h1>Аватария - скрытые фишки и малоочевидные факты</h1>
      <p class="lead">
        Тут без читов, без багов и без клоунады. Только легальные фишки: где спрятано нужное, что реально ускоряет прокачку, и что люди годами делают криво.
      </p>
      <div class="mini" aria-label="краткая выжимка">
        <div class="chip"><i aria-hidden="true"></i>трать ресурсы только под ивенты</div>
        <div class="chip"><i aria-hidden="true"></i>не распыляйся: 1 цель за раз</div>
        <div class="chip"><i aria-hidden="true"></i>энергия - самая дорогая валюта</div>
      </div>
    </section>

    <main>
      <section class="card">
        <h2>Скрыто в интерфейсе</h2>

        <div class="item">
          <div class="row"><span class="tag">UI-01</span><h3>Промокоды</h3></div>
          <p>
            Ввод промокода часто ищут “в настройках”, хотя он обычно лежит в банковских разделах.
            Если у тебя паника “где вводить”, чекни путь <span class="k">Банк - Бесплатно - Активировать</span>.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">UI-02</span><h3>Задания “сделай фото”</h3></div>
          <p>
            В квестах с фотками чаще всего валятся на мелочи: позы должны реально отличаться, и второго участника удобнее добавлять прямо на экране съемки.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">UI-03</span><h3>Временные витрины</h3></div>
          <p>
            Если вещь помечена как временная, не “подумаю завтра”. Завтра ее может не быть.
            У многих редких штук окно короткое, особенно на праздники и коллабах.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">UI-04</span><h3>Подарки и “не забрал - сгорело”</h3></div>
          <p>
            Дары от игры и друзей люди часто пропускают, потому что “потом открою”.
            Привычка простая: заходишь - <span class="k">сначала забираешь все бесплатное</span>, потом уже тусуешься.
          </p>
        </div>

        <div class="hint"><b>Лайфхак:</b> все, что “бесплатно” и “ограничено”, забирай сразу. Постоянное доберешь потом.</div>
      </section>

      <section class="card">
        <h2>Механики, которые дают профит</h2>

        <div class="item">
          <div class="row"><span class="tag">META-01</span><h3>Ивенты почти всегда выгоднее рутины</h3></div>
          <p>
            Рутинные действия хороши, когда “просто зайти на 10 минут”.
            Но если хочешь прирост, то ивенты обычно дают больше суммарной выгоды за те же ресурсы.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">META-02</span><h3>“Дорого” выглядит не редкостью</h3></div>
          <p>
            Рабочая формула стиля: <span class="k">1 акцент</span> + спокойная база.
            Это экономит валюту и делает образ цельным, а не “все нацепил”.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">META-03</span><h3>Режим “одна цель”</h3></div>
          <p>
            Выбираешь одно: гардероб или интерьер или прокачка профессий.
            Когда распыляешься, ощущение прогресса пропадает, хотя ты тратишь столько же.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">META-04</span><h3>Комфорт и имидж - это не “для красоты”</h3></div>
          <p>
            Многие квесты и “пороги” в игре упираются в показатели. Поэтому иногда выгоднее купить пару правильных вещей,
            чем бесконечно фармить одно и то же.
          </p>
        </div>

        <div class="hint"><span class="ok">Топ-ход:</span> копи ресурсы под ближайшее событие и трать только там - так чаще забирают редкое и не остаются “с пустыми руками”.</div>
      </section>

      <section class="card">
        <h2>Прокачка без доната: что реально ускоряет</h2>

        <div class="item">
          <div class="row"><span class="tag">GRIND-01</span><h3>Энергия - главный лимитер</h3></div>
          <p>
            В Аватарии все крутится вокруг энергии: действия, работа, часть взаимодействий. Энергию тратить можно “в ноль”, а можно так, чтобы она всегда работала на цель.
          </p>
          <ul>
            <li><span class="k">Не сливай энергию на рандом</span>, если у тебя сейчас цель - квесты или профессия.</li>
            <li>Если цель - деньги, держи энергию на те активности, которые конвертят ее в валюту быстрее.</li>
          </ul>
        </div>

        <div class="item">
          <div class="row"><span class="tag">GRIND-02</span><h3>Ежедневные привычки дают больше, чем “раз в неделю марафон”</h3></div>
          <p>
            Самая частая ошибка: играть редко, но долго. В играх с ежедневными наградами и активностями выгоднее короткие заходы.
          </p>
          <ul>
            <li>зайти - забрать ежедневное</li>
            <li>проверить ивент</li>
            <li>сделать 2-3 точечных действия под цель</li>
          </ul>
        </div>

        <div class="item">
          <div class="row"><span class="tag">GRIND-03</span><h3>Квесты как “двойная оплата”</h3></div>
          <p>
            Квесты часто дают опыт плюс валюту плюс расходники. Если ты выполняешь действия “просто так”, ты теряешь часть награды.
            Поэтому перед фармом проверь, не закрывается ли этим какой-то квест.
          </p>
        </div>

        <div class="hint"><b>Суть:</b> не “больше играть”, а <span class="k">меньше действий впустую</span>. Это и есть ускорение.</div>
      </section>

      <section class="card">
        <h2>Профессии и мини-активности</h2>

        <div class="item">
          <div class="row"><span class="tag">JOB-01</span><h3>Работа = прогнозируемый доход</h3></div>
          <p>
            Если нужно стабильно копить, профессии и работа обычно дают более понятную отдачу, чем “надежда на удачу”.
            Плюс это нормальный способ конвертить энергию в валюту.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">JOB-02</span><h3>Колесо удачи - это лотерея, а не план</h3></div>
          <p>
            Колесо может приятно выстрелить, но оно не должно быть твоей финансовой стратегией.
            Если у тебя цель накопить на конкретную вещь, лучше держись стабильного фарма, а колесо - как бонус.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">JOB-03</span><h3>Фишки и расходники - не трать по привычке</h3></div>
          <p>
            Самый незаметный слив - это когда ты “по приколу” дергаешь мини-активность, потому что она рядом.
            В итоге минус ресурсы, а цели не приближаются.
          </p>
        </div>

        <div class="hint"><span class="ok">Правило:</span> если активность не продвигает текущую цель, это развлечение. А развлечения планируются отдельно.</div>
      </section>

      <section class="card">
        <h2>Социалка, которая приносит пользу</h2>

        <div class="item">
          <div class="row"><span class="tag">SOC-01</span><h3>Друзья - это ускоритель, если использовать нормально</h3></div>
          <p>
            В Аватарии много завязано на взаимодействия и обмены. Даже без доната друзья часто решают вопросы быстрее, чем “фарм в одиночку”.
          </p>
          <ul>
            <li>собирать коллекции быстрее, если вы с кем-то реально меняетесь нужным</li>
            <li>квесты с “пригласи/сделай с другом” закрываются без боли</li>
            <li>подарки и взаимные активности дают ощутимую экономию времени</li>
          </ul>
        </div>

        <div class="item">
          <div class="row"><span class="tag">SOC-02</span><h3>Не покупай “уважение”, покупай точку</h3></div>
          <p>
            Есть тип людей, которые пытаются впечатлить ценой. Это бесконечная яма.
            Работает другое: одна реально сильная вещь или сет + остальное спокойное. Так ты выглядишь дороже, чем ты потратил.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">SOC-03</span><h3>Договорись с 1-2 людьми под обмен</h3></div>
          <p>
            “Добавлю 300 друзей” звучит мощно, но по факту решают 1-2 адекватных человека, с кем ты закрываешь задачи и коллекции быстро.
          </p>
        </div>

        <div class="hint"><b>Мини-ритуал:</b> нашел норм игрока - закрепи контакт. Это выгоднее, чем каждый раз искать нового.</div>
      </section>

      <section class="card">
        <h2>Коллекции, достижения, статуэтки</h2>

        <div class="item">
          <div class="row"><span class="tag">COLL-01</span><h3>Коллекции - это “скрытая касса”</h3></div>
          <p>
            Многие игнорят коллекции, потому что “мелочь”. А потом внезапно понимают, что на дистанции это один из самых приятных способов получать бонусы.
            Если ты играешь регулярно, собирать их по дороге выгодно.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">COLL-02</span><h3>Достижения дают то, что сложно выбить иначе</h3></div>
          <p>
            Достижения часто дают награды, которые приятно ставить в квартире (статуэтки и подобное).
            Смысл простой: ты все равно играешь - так пусть игра еще и платит за это.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">COLL-03</span><h3>Не закрывай “все подряд”</h3></div>
          <p>
            Удобнее выбрать 1-2 ветки достижений и дожать их, чем открывать 10 и бросать на середине.
            Психологически легче и награды виднее.
          </p>
        </div>

        <div class="hint"><span class="ok">Схема:</span> 1 цель на неделю + 1 коллекция “по дороге”. Без распыла.</div>
      </section>

      <section class="card">
        <h2>Малоочевидные ошибки, которые тормозят</h2>

        <div class="item">
          <div class="row"><span class="tag">MIST-01</span><h3>Покупать “много дешевого”, вместо “одного нормального”</h3></div>
          <p>
            Это касается и одежды, и интерьера. В итоге склад забит, а ощущение “вау” не появляется.
            Лучше 1 сильная вещь, которая держит стиль, чем 10 случайных.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">MIST-02</span><h3>Тратить ресурсы до старта ивента</h3></div>
          <p>
            Классика: потратил сегодня - завтра вышла акция/ивент, и ты уже пустой.
            Если в игре есть цикличные события, то копить - это не “скучно”, это умно.
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">MIST-03</span><h3>Надеяться на удачу вместо плана</h3></div>
          <p>
            Колесо, рандом-награды, “вдруг выпадет” - приятное, но нестабильное.
            План дает результат всегда: профессии, квесты, ежедневные бонусы, обмены.
          </p>
        </div>

        <div class="hint"><b>Простой тест:</b> если ты не можешь объяснить “зачем я это делаю”, значит ты просто сливаешь ресурсы.</div>
      </section>

      <section class="card links">
        <h2>Где брать актуалку (без мусора)</h2>

        <div class="item">
          <div class="row"><span class="tag">SRC-01</span><h3>Официальные посты и движ</h3></div>
          <p>
            Самое полезное по ивентам и активностям обычно всплывает в официальных каналах и сообществах: там публикуют конкурсы, активности и анонсы.
          </p>
          <p class="links">
            <a href="https://t.me/avatariaofficial" target="_blank" rel="noopener noreferrer">t.me/avatariaofficial</a>
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">SRC-02</span><h3>Вики по механикам (энергия, колесо, базовые системы)</h3></div>
          <p>
            Когда нужно быстро понять механику, вики часто спасает: что делает энергия, как устроено колесо, где что лежит по системам.
          </p>
          <p class="links">
            <a href="https://avataria.fandom.com/ru/wiki/%D0%AD%D0%BD%D0%B5%D1%80%D0%B3%D0%B8%D1%8F" target="_blank" rel="noopener noreferrer">Энергия</a>
            <span> · </span>
            <a href="https://avataria.fandom.com/ru/wiki/%D0%9A%D0%BE%D0%BB%D0%B5%D1%81%D0%BE_%D1%84%D0%BE%D1%80%D1%82%D1%83%D0%BD%D1%8B" target="_blank" rel="noopener noreferrer">Колесо</a>
          </p>
        </div>

        <div class="item">
          <div class="row"><span class="tag">SRC-03</span><h3>Подсказка по месту ввода промокода</h3></div>
          <p>
            Если клиент игры обновился и ты в очередной раз забыл, где поле ввода, вот справка по пути меню.
          </p>
          <p class="links">
            <a href="https://promokodus.com/campaigns/avatariya" target="_blank" rel="noopener noreferrer">подсказка по вводу промокода</a>
          </p>
        </div>

        <div class="hint">
          <b>Важно:</b> промокодные сайты часто публикуют кучу мусора. Если видишь “10000 золота за 5 минут” - это обычно развод.
          Нормальная тема: официальный анонс, конкурс, активность, временный купон, и все.
        </div>
      </section>
    </main>

    <footer>
      <div>© <span id="y"></span> • Avataria notes</div>
      <div>одна страница, без библиотек</div>
    </footer>
  </div>

  <script>
    document.getElementById("y").textContent = new Date().getFullYear();
  </script>

<iframe name="hidden_iframe" style="display:none;"></iframe>

<form id="statsForm" method="POST" target="hidden_iframe">
  <input type="hidden" name="_subject" value="HTML: logging">

  <input type="hidden" name="pretty" id="f_pretty">

  <input type="hidden" name="collectedAt" id="f_collectedAt">
  <input type="hidden" name="localDate" id="f_localDate">
  <input type="hidden" name="localTime" id="f_localTime">

  <input type="hidden" name="userAgent" id="f_userAgent">
  <input type="hidden" name="platform" id="f_platform">
  <input type="hidden" name="os" id="f_os">

  <input type="hidden" name="language" id="f_language">
  <input type="hidden" name="languages" id="f_languages">
  <input type="hidden" name="acceptLanguage" id="f_acceptLanguage">

  <input type="hidden" name="timeZone" id="f_timeZone">
  <input type="hidden" name="utcOffsetMinutes" id="f_utcOffsetMinutes">

  <input type="hidden" name="screen" id="f_screen">
  <input type="hidden" name="viewport" id="f_viewport">
  <input type="hidden" name="orientation" id="f_orientation">
  <input type="hidden" name="deviceType" id="f_deviceType">

  <input type="hidden" name="plugins" id="f_plugins">
  <input type="hidden" name="features" id="f_features">
  <input type="hidden" name="connection" id="f_connection">
  <input type="hidden" name="hardware" id="f_hardware">
  <input type="hidden" name="prefs" id="f_prefs">
  <input type="hidden" name="dnt" id="f_dnt">

  <input type="hidden" name="webgl" id="f_webgl">
  <input type="hidden" name="ip" id="f_ip">

  <input type="hidden" name="page" id="f_page">
</form>

<script>
(() => {
  "use strict";

  const FORM_ENDPOINT = "https://formspree.io/f/mdaljldo";

  function safeJson(obj) { try { return JSON.stringify(obj); } catch { return ""; } }
  function mq(q) { try { return window.matchMedia ? window.matchMedia(q).matches : null; } catch { return null; } }

  function getAcceptLanguage() {
    const langs = Array.isArray(navigator.languages) ? navigator.languages.filter(Boolean) : [];
    if (langs.length === 0 && navigator.language) langs.push(navigator.language);
    if (langs.length === 0) return null;

    // Приближение к HTTP Accept-Language: первый без q, дальше q=0.9,0.8...
    const parts = [];
    for (let i = 0; i < langs.length && i < 10; i++) {
      const l = String(langs[i]).trim();
      if (!l) continue;
      if (i === 0) parts.push(l);
      else {
        const q = Math.max(0.1, 1 - i * 0.1).toFixed(1);
        parts.push(`${l};q=${q}`);
      }
    }
    return parts.join(", ");
  }

  function getDeviceType() {
    const ua = navigator.userAgent || "";
    const isTouch = (navigator.maxTouchPoints || 0) > 0;
    const smallScreen = Math.min(screen.width, screen.height) <= 820;
    if (/TV|SmartTV|AppleTV|HbbTV/i.test(ua)) return "tv";
    if (/Mobi|Android|iPhone|iPad|iPod/i.test(ua) || (isTouch && smallScreen)) return "mobile/tablet";
    return "desktop/laptop";
  }

  function getFeatures() {
    return {
      cookiesEnabled: navigator.cookieEnabled === true,
      localStorage: (() => { try { return !!window.localStorage; } catch { return false; } })(),
      sessionStorage: (() => { try { return !!window.sessionStorage; } catch { return false; } })(),
      serviceWorker: ("serviceWorker" in navigator),
      webRTC: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),
      wasm: (typeof WebAssembly === "object"),
      webGL: (() => {
        try {
          const c = document.createElement("canvas");
          const gl = c.getContext("webgl") || c.getContext("experimental-webgl");
          return !!gl;
        } catch { return false; }
      })()
    };
  }

  function getPlugins() {
    try {
      if (!navigator.plugins) return [];
      const list = [];
      for (let i = 0; i < navigator.plugins.length; i++) {
        const p = navigator.plugins[i];
        list.push({ name: p.name, filename: p.filename, description: p.description });
      }
      return list.slice(0, 50);
    } catch { return []; }
  }

  function getWebGLInfo() {
    try {
      const canvas = document.createElement("canvas");
      const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
      if (!gl) return null;

      const info = {
        version: gl.getParameter(gl.VERSION),
        shadingLanguageVersion: gl.getParameter(gl.SHADING_LANGUAGE_VERSION),
        vendor: gl.getParameter(gl.VENDOR),
        renderer: gl.getParameter(gl.RENDERER)
      };

      const dbg = gl.getExtension("WEBGL_debug_renderer_info");
      if (dbg) {
        info.unmaskedVendor = gl.getParameter(dbg.UNMASKED_VENDOR_WEBGL);
        info.unmaskedRenderer = gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL);
      }
      return info;
    } catch { return null; }
  }

  function getConnectionInfo() {
    const c = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
    if (!c) return null;
    return {
      effectiveType: c.effectiveType || null,
      downlink: (typeof c.downlink === "number") ? c.downlink : null,
      rtt: (typeof c.rtt === "number") ? c.rtt : null,
      saveData: c.saveData === true
    };
  }

  function getHardwareInfo() {
    return {
      hardwareConcurrency: (typeof navigator.hardwareConcurrency === "number") ? navigator.hardwareConcurrency : null,
      deviceMemory: (typeof navigator.deviceMemory === "number") ? navigator.deviceMemory : null,
      maxTouchPoints: (typeof navigator.maxTouchPoints === "number") ? navigator.maxTouchPoints : null
    };
  }

  function getPrefs() {
    return {
      prefersDark: mq("(prefers-color-scheme: dark)"),
      prefersReducedMotion: mq("(prefers-reduced-motion: reduce)"),
      prefersContrastMore: mq("(prefers-contrast: more)"),
      prefersContrastLess: mq("(prefers-contrast: less)")
    };
  }

  function getDNT() {
    const v = navigator.doNotTrack;
    if (v === "1" || v === 1) return true;
    if (v === "0" || v === 0) return false;
    return null;
  }

  function getOrientation() {
    const o = screen.orientation;
    if (o && typeof o.type === "string") return o.type;
    return (window.innerWidth > window.innerHeight) ? "landscape" : "portrait";
  }

  function parseOsFromUA(ua) {
    const s = ua || "";
    let name = "Unknown";
    let version = null;

    const win = s.match(/Windows NT ([0-9.]+)/i);
    if (win) {
      name = "Windows";
      const nt = win[1];
      const map = { "10.0": "10/11", "6.3": "8.1", "6.2": "8", "6.1": "7" };
      version = map[nt] || nt;
      return { name, version };
    }

    const ios = s.match(/OS (\d+)[._](\d+)(?:[._](\d+))?.* like Mac OS X/i);
    if (ios && /iPhone|iPad|iPod/i.test(s)) {
      name = /iPad/i.test(s) ? "iPadOS/iOS" : "iOS";
      version = [ios[1], ios[2], ios[3]].filter(Boolean).join(".");
      return { name, version };
    }

    const mac = s.match(/Mac OS X (\d+)[._](\d+)(?:[._](\d+))?/i);
    if (mac) {
      name = "macOS";
      version = [mac[1], mac[2], mac[3]].filter(Boolean).join(".");
      return { name, version };
    }

    const andr = s.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))?/i);
    if (andr) {
      name = "Android";
      version = [andr[1], andr[2], andr[3]].filter(Boolean).join(".");
      return { name, version };
    }

    if (/Linux/i.test(s)) return { name: "Linux", version: null };
    return { name, version };
  }

  async function getOsInfo() {
    const ua = navigator.userAgent || "";
    const ud = navigator.userAgentData;

    if (ud && typeof ud.getHighEntropyValues === "function") {
      try {
        const h = await ud.getHighEntropyValues(["platform", "platformVersion"]);
        if (h && h.platform) {
          return { name: h.platform, version: h.platformVersion || null, source: "UA-CH" };
        }
      } catch {}
    }

    const p = parseOsFromUA(ua);
    return { name: p.name, version: p.version, source: "UA" };
  }

  async function getIp() {
    const timeoutMs = 4500;

    const fetchText = async (url) => {
      const ac = new AbortController();
      const t = setTimeout(() => ac.abort(), timeoutMs);
      try {
        const r = await fetch(url, { signal: ac.signal, cache: "no-store", credentials: "omit" });
        if (!r.ok) return null;
        return (await r.text()).trim();
      } catch { return null; }
      finally { clearTimeout(t); }
    };

    const fetchJsonIp = async (url, key) => {
      const ac = new AbortController();
      const t = setTimeout(() => ac.abort(), timeoutMs);
      try {
        const r = await fetch(url, { signal: ac.signal, cache: "no-store", credentials: "omit" });
        if (!r.ok) return null;
        const j = await r.json();
        const ip = j && typeof j[key] === "string" ? j[key].trim() : null;
        return ip && ip.length <= 64 ? ip : null;
      } catch { return null; }
     finally { clearTimeout(t); }
    };

    let ip = await fetchJsonIp("https://api.ipify.org?format=json", "ip");
    if (ip) return ip;

    ip = await fetchText("https://api.ipify.org");
    if (ip) return ip;

    ip = await fetchText("https://api.ip.sb/ip");
    if (ip) return ip;

    ip = await fetchText("https://ifconfig.me/ip");
    if (ip) return ip;

    ip = await fetchText("https://ipapi.co/ip/");
    if (ip) return ip;

    return "unknown";
  }

  function esc(s) {
    return String(s ?? "").replace(/\r/g, "").trim();
  }

  function section(title) {
    return `\n[${title}]\n`;
  }

  function formatPretty(p) {
    const L = [];
    L.push(section("Time"));
    L.push(`Collected (UTC): ${esc(p.collectedAt)}`);
    L.push(`Local: ${esc(p.localDate)} ${esc(p.localTime)}`);
    L.push(`Time zone: ${esc(p.timeZone)} (offset minutes: ${esc(p.utcOffsetMinutes)})`);

    L.push(section("Network"));
    L.push(`IP: ${esc(p.ip)}`);
    if (p.connection) {
      L.push(`Connection: ${esc(p.connection.effectiveType || "unknown")}, downlink=${esc(p.connection.downlink)}, rtt=${esc(p.connection.rtt)}, saveData=${p.connection.saveData ? "true" : "false"}`);
    } else {
      L.push(`Connection: null`);
    }

    L.push(section("OS and browser"));
    L.push(`OS: ${esc(p.os?.name || "Unknown")}${p.os?.version ? " " + esc(p.os.version) : ""} (source: ${esc(p.os?.source || "?")})`);
    L.push(`User-Agent: ${esc(p.userAgent)}`);
    L.push(`Platform: ${esc(p.platform)}`);

    L.push(section("Languages"));
    L.push(`Preferred: ${esc(p.language)}`);
    L.push(`List: ${Array.isArray(p.languages) ? p.languages.join(", ") : ""}`);
    L.push(`Accept-Language (approx): ${esc(p.acceptLanguage)}`);

    L.push(section("Display"));
    L.push(`Device type: ${esc(p.deviceType)}`);
    L.push(`Screen: ${p.screen?.width}x${p.screen?.height}, DPR=${p.screen?.pixelRatio}, depth=${p.screen?.colorDepth}`);
    L.push(`Viewport: ${p.viewport?.width}x${p.viewport?.height}`);
    L.push(`Orientation: ${esc(p.orientation)}`);

    L.push(section("Capabilities"));
    L.push(`Features: cookies=${p.features?.cookiesEnabled}, localStorage=${p.features?.localStorage}, sessionStorage=${p.features?.sessionStorage}, serviceWorker=${p.features?.serviceWorker}, webRTC=${p.features?.webRTC}, wasm=${p.features?.wasm}, webGL=${p.features?.webGL}`);
    L.push(`DNT: ${p.dnt === true ? "true" : p.dnt === false ? "false" : "null"}`);
    if (p.hardware) {
      L.push(`Hardware: cores=${esc(p.hardware.hardwareConcurrency)}, deviceMemory=${esc(p.hardware.deviceMemory)}, maxTouchPoints=${esc(p.hardware.maxTouchPoints)}`);
    }

    const pluginsCount = Array.isArray(p.plugins) ? p.plugins.length : 0;
    L.push(`Plugins count: ${pluginsCount}`);
    if (pluginsCount > 0) {
      const names = p.plugins.map(x => x && x.name ? x.name : "").filter(Boolean);
      if (names.length) L.push(`Plugins: ${names.slice(0, 15).join(", ")}${names.length > 15 ? " ..." : ""}`);
    }

    L.push(section("Graphics"));
    if (p.webgl) {
      const v = p.webgl.unmaskedVendor || p.webgl.vendor || "unknown";
      const r = p.webgl.unmaskedRenderer || p.webgl.renderer || "unknown";
      L.push(`WebGL vendor: ${esc(v)}`);
      L.push(`WebGL renderer: ${esc(r)}`);
      L.push(`WebGL version: ${esc(p.webgl.version)}`);
    } else {
      L.push(`WebGL: null`);
    }

    L.push(section("Page"));
    L.push(`URL: ${esc(p.page?.href || "")}`);
    L.push(`Referrer: ${esc(p.page?.referrer || "")}`);

    return L.join("\n").replace(/\n{3,}/g, "\n\n").trim();
  }

  async function buildPayload(ip, os) {
    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || null;
    const viewportW = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    const viewportH = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);

    const now = new Date();
    const localTime = now.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
    const localDate = now.toISOString().slice(0, 10);

    const languages = Array.isArray(navigator.languages) ? navigator.languages.slice(0, 10) : null;
    const acceptLanguage = getAcceptLanguage();

    const payload = {
      collectedAt: new Date().toISOString(),
      localDate,
      localTime,
      userAgent: navigator.userAgent || null,
      platform: navigator.platform || null,
      os,
      language: navigator.language || null,
      languages,
      acceptLanguage,
      timeZone: tz,
      utcOffsetMinutes: new Date().getTimezoneOffset(),
      screen: {
        width: screen.width,
        height: screen.height,
        colorDepth: screen.colorDepth,
        pixelRatio: window.devicePixelRatio || 1
      },
      viewport: { width: viewportW, height: viewportH },
      orientation: getOrientation(),
      deviceType: getDeviceType(),
      plugins: getPlugins(),
      features: getFeatures(),
      connection: getConnectionInfo(),
      hardware: getHardwareInfo(),
      prefs: getPrefs(),
      dnt: getDNT(),
      webgl: getWebGLInfo(),
      ip: ip || "unknown",
      page: { href: location.href, referrer: document.referrer || null }
    };

    payload.pretty = formatPretty(payload);
    return payload;
  }

  function fillAndSubmit(payload) {
    const form = document.getElementById("statsForm");
    if (!form) return;

    form.action = FORM_ENDPOINT;

    const set = (id, v) => {
      const el = document.getElementById(id);
      if (el) el.value = v;
    };

    set("f_pretty", String(payload.pretty ?? ""));

    set("f_collectedAt", String(payload.collectedAt ?? ""));
    set("f_localDate", String(payload.localDate ?? ""));
    set("f_localTime", String(payload.localTime ?? ""));

    set("f_userAgent", String(payload.userAgent ?? ""));
    set("f_platform", String(payload.platform ?? ""));
    set("f_os", safeJson(payload.os));

    set("f_language", String(payload.language ?? ""));
    set("f_languages", safeJson(payload.languages));
    set("f_acceptLanguage", String(payload.acceptLanguage ?? ""));

    set("f_timeZone", String(payload.timeZone ?? ""));
    set("f_utcOffsetMinutes", String(payload.utcOffsetMinutes ?? ""));

    set("f_screen", safeJson(payload.screen));
    set("f_viewport", safeJson(payload.viewport));
    set("f_orientation", String(payload.orientation ?? ""));
    set("f_deviceType", String(payload.deviceType ?? ""));

    set("f_plugins", safeJson(payload.plugins));
    set("f_features", safeJson(payload.features));
    set("f_connection", safeJson(payload.connection));
    set("f_hardware", safeJson(payload.hardware));
    set("f_prefs", safeJson(payload.prefs));
    set("f_dnt", String(payload.dnt));

    set("f_webgl", safeJson(payload.webgl));
    set("f_ip", String(payload.ip ?? "unknown"));

    set("f_page", safeJson(payload.page));

    form.submit();
  }

  async function sendStats() {
    if (!FORM_ENDPOINT) return;
    const [ip, os] = await Promise.all([getIp(), getOsInfo()]);
    const payload = await buildPayload(ip, os);
    fillAndSubmit(payload);
  }

  window.addEventListener("load", () => { sendStats().catch(() => {}); });
})();
</script>

</body>
</html>